## 유튜브 실시간 댓글 필터링 (로컬 모델 서버 + 크롬 확장)

### 구성
- 서버: `FastAPI` 기반 로컬 추론 서버 (`server/`)
- 모델: `model/` 폴더(HF 형식)에서 로드 (라벨: 0 정상, 1 약간 악성, 2 악성)
- 크롬 확장: `extension/` (MV3). 유튜브 라이브 채팅을 감시하고 로컬 서버로 배치 분류 요청 후 차단
- **학습 데이터 수집**: 사용자가 직접 댓글을 라벨링하여 모델을 개선할 수 있는 기능

### 사전 준비 (Windows)
1. Python 3.10+ 설치
2. Chrome 브라우저 설치

### 서버 실행
1. `server/run.bat` 더블클릭 (최초 실행 시 가상환경 생성 및 의존성 설치)
2. 서버 기본 주소: `http://127.0.0.1:8000`
   - 헬스체크: `http://127.0.0.1:8000/health`
   - 예측: `POST /predict` { "texts": ["문장1", "문장2"] }

### 크롬 확장 설치
1. Chrome 주소창에 `chrome://extensions` 입력
2. 우측 상단 "개발자 모드" 활성화
3. "압축해제된 확장 프로그램을 로드" 클릭 → `extension/` 폴더 선택
4. 로드 후 확장 상세 화면에서 "옵션" 열기 → 서버 주소가 `http://127.0.0.1:8000`인지 확인하고 저장

### 사용 방법
1. 유튜브 라이브 채팅 페이지(동영상 재생 페이지 또는 `.../live_chat`)를 열면 자동으로 감지합니다.
2. 메시지는 배치로 로컬 서버에 전송되어 0/1/2 라벨을 받습니다.
3. 옵션에서 설정 가능:
   - 차단 기준: 2(악성만), 1(약간 악성 이상), 0(전부 표시)
   - 차단 동작: 숨김 / 블러 / 삭제(가능 시)
   - 라벨 배지 표시: 작성자 옆에 라벨 뱃지 표시
   - 툴바 팝업에서 빠르게 기준/동작 변경, 차단 카운트 확인

### 학습 데이터 수집 및 모델 개선
1. **학습 모드 활성화**: 확장 프로그램 팝업에서 "학습 데이터 수집" → "수집 모드" 토글을 켭니다.
2. **댓글 라벨링**: 학습 모드가 활성화되면 댓글을 클릭하여 라벨을 지정할 수 있습니다.
   - 정상: 무해한 댓글
   - 약간 악성: 부적절하지만 심각하지 않은 댓글
   - 악성: 명백히 부적절한 댓글
3. **학습 데이터 확인**: 팝업에서 수집된 데이터 개수와 라벨 분포를 확인할 수 있습니다.
4. **모델 재학습**: 충분한 데이터가 수집되면 `server/train.bat`을 실행하여 모델을 재학습시킵니다.
5. **모델 적용**: 학습 완료 후 확장 프로그램에서 "모델 재로드" 버튼을 클릭하여 새 모델을 적용합니다.

### 라벨 규칙
- 0: 정상 (표시)
- 1: 약간 악성 (옵션에 따라 표시/차단)
- 2: 악성 (기본 차단)

### 문제 해결
- 서버가 응답하지 않으면 `server/run.bat`이 실행 중인지 확인하고, `options`에서 "서버 점검"으로 `/health` 호출을 확인하세요.
- GPU가 있으면 자동 사용(CUDA). 없으면 CPU 사용.

### 구조
```
yout/
  model/ ... (기본 모델)
  training_data/ ... (학습 데이터, 자동 생성)
  server/
    app.py (서버 + 학습 데이터 수집 API)
    train.py (모델 재학습 스크립트)
    train.bat (학습 실행 배치 파일)
    requirements.txt
    run.bat
  extension/
    manifest.json
    background.js (학습 데이터 전송 기능 추가)
    content.js (학습 모드 클릭 이벤트 추가)
    popup.html (학습 데이터 수집 UI 추가)
    popup.js (학습 통계 및 모델 재로드 기능)
    popup.css (새로운 UI 스타일)
    options.html
```


